<dom-module id="indiag-editor">
    <style>
        :host {
            font-family: sans-serif;
        }

        .link {
            stroke: #000;
            stroke-width: 1px;
        }

        .node {
            stroke: steelblue;
            fill: #fff;
        }

        .node text {
            stroke: transparent;
            fill: steelblue;
        }

    </style>
    <template>
        <div relative horizontal layout>
            <textarea id="editor">
Title = "C.CA.FA Force Accounts"

1: "Force Account Overview"
    "Open" => 2
    "Report" => 3
    "Other" => 2

2: "Force Account Summary"
    "Open" => 3

3: "Force Account Reporting"
            </textarea>
            <div id="errors"></div>
            <button id="generate">Generate</button>
            <svg id="output" flex></svg>
        </div>
    </template>
</dom-module>

<script src="../bower_components/d3/d3.min.js"></script>
<script src="../contrib/canvasutilities.js"></script>
<script src="../dist/app.js"></script>
<script src="../grammar/grammar.js"></script>

<script>
    Polymer({
        is: 'indiag-editor',
        listeners: {
            'generate.tap': 'generate'
        },
        ready: function () {
            this.generator = new D3Generator(this.$.output);
        },
        generate: function () {
            try {
                this.generator.generate(this.$.editor.value.trim());
            } catch (e) {
                this.$.errors.innerHTML = '<p>There was a problem with the diagram text:</p>' +
                '<p>'+e.message+'</p>'+
                '<p>On line: ' + e.line + ' and column ' + e.column + '</p>';
            }
        }
    });
</script>